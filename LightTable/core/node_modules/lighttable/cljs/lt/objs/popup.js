// Compiled by ClojureScript 0.0-2138
goog.provide('lt.objs.popup');
goog.require('cljs.core');
goog.require('lt.util.dom');
goog.require('lt.objs.context');
goog.require('lt.objs.context');
goog.require('lt.util.dom');
goog.require('lt.objs.canvas');
goog.require('lt.objs.command');
goog.require('lt.objs.keyboard');
goog.require('lt.objs.canvas');
goog.require('lt.object');
goog.require('lt.object');
goog.require('lt.objs.command');
goog.require('lt.objs.keyboard');
lt.objs.popup._STAR_no_close_STAR_ = null;
lt.objs.popup.__BEH__on_click_destroy = (function __BEH__on_click_destroy(this$){return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close!","close!",3951350939));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","on-click-destroy","lt.objs.popup/on-click-destroy",4693561385),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__on_click_destroy,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"click","click",1108654330),null], null), null));
lt.objs.popup.__BEH__close_BANG_ = (function __BEH__close_BANG_(this$){lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close","close",1108660586));
lt.object.destroy_BANG_.call(null,this$);
var temp__4090__auto__ = cljs.core.seq.call(null,lt.object.by_tag.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766)));if(temp__4090__auto__)
{var others = temp__4090__auto__;return lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766),cljs.core.last.call(null,others));
} else
{return lt.objs.context.out_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","close!","lt.objs.popup/close!",4613970955),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__close_BANG_,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close!","close!",3951350939),null], null), null));
lt.objs.popup.__BEH__refocus_on_close = (function __BEH__refocus_on_close(this$){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"tabs.focus-active","tabs.focus-active",2001074557));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","refocus-on-close","lt.objs.popup/refocus-on-close",2521298612),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__refocus_on_close,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close","close",1108660586),null], null), null));
lt.objs.popup.__BEH__change_active_button = (function __BEH__change_active_button(this$,dir){var buttons = lt.util.dom.$$.call(null,".button",lt.object.__GT_content.call(null,this$));var button = cljs.core.mod.call(null,(new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)) + dir),cljs.core.count.call(null,buttons));lt.util.dom.remove_class.call(null,(buttons[new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))]),new cljs.core.Keyword(null,"active","active",3885920888));
lt.util.dom.add_class.call(null,(buttons[button]),new cljs.core.Keyword(null,"active","active",3885920888));
return lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"button","button",3931183780),button], null));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","change-active-button","lt.objs.popup/change-active-button",2736197342),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__change_active_button,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"move-active","move-active",3635471348),null], null), null));
lt.objs.popup.__BEH__exec_active = (function __BEH__exec_active(this$){var buttons = lt.util.dom.$$.call(null,".button",lt.object.__GT_content.call(null,this$));return lt.util.dom.trigger.call(null,(buttons[new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))]),new cljs.core.Keyword(null,"click","click",1108654330));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","exec-active","lt.objs.popup/exec-active",1054217124),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__exec_active,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"exec-active","exec-active",533892916),null], null), null));
lt.objs.popup.remain_open = (function remain_open(){return lt.objs.popup._STAR_no_close_STAR_ = true;
});
lt.objs.popup.__GT_button = (function __GT_button(this$,p__10930){var map__10939 = p__10930;var map__10939__$1 = ((cljs.core.seq_QMARK_.call(null,map__10939))?cljs.core.apply.call(null,cljs.core.hash_map,map__10939):map__10939);var post_action = cljs.core.get.call(null,map__10939__$1,new cljs.core.Keyword(null,"post-action","post-action",4039331701));var action = cljs.core.get.call(null,map__10939__$1,new cljs.core.Keyword(null,"action","action",3885920680));var label = cljs.core.get.call(null,map__10939__$1,new cljs.core.Keyword(null,"label","label",1116631654));var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li.button","li.button",2481585205),label], null));var seq__10940_10947 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){var _STAR_no_close_STAR_10944 = lt.objs.popup._STAR_no_close_STAR_;try{lt.objs.popup._STAR_no_close_STAR_ = null;
if(cljs.core.fn_QMARK_.call(null,action))
{action.call(null);
} else
{}
if(cljs.core.truth_(lt.objs.popup._STAR_no_close_STAR_))
{} else
{lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close!","close!",3951350939));
}
if(cljs.core.fn_QMARK_.call(null,post_action))
{return post_action.call(null);
} else
{return null;
}
}finally {lt.objs.popup._STAR_no_close_STAR_ = _STAR_no_close_STAR_10944;
}})], null)));var chunk__10941_10948 = null;var count__10942_10949 = 0;var i__10943_10950 = 0;while(true){
if((i__10943_10950 < count__10942_10949))
{var vec__10945_10951 = cljs.core._nth.call(null,chunk__10941_10948,i__10943_10950);var ev__4336__auto___10952 = cljs.core.nth.call(null,vec__10945_10951,0,null);var func__4337__auto___10953 = cljs.core.nth.call(null,vec__10945_10951,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10952,func__4337__auto___10953);
{
var G__10954 = seq__10940_10947;
var G__10955 = chunk__10941_10948;
var G__10956 = count__10942_10949;
var G__10957 = (i__10943_10950 + 1);
seq__10940_10947 = G__10954;
chunk__10941_10948 = G__10955;
count__10942_10949 = G__10956;
i__10943_10950 = G__10957;
continue;
}
} else
{var temp__4092__auto___10958 = cljs.core.seq.call(null,seq__10940_10947);if(temp__4092__auto___10958)
{var seq__10940_10959__$1 = temp__4092__auto___10958;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10940_10959__$1))
{var c__4150__auto___10960 = cljs.core.chunk_first.call(null,seq__10940_10959__$1);{
var G__10961 = cljs.core.chunk_rest.call(null,seq__10940_10959__$1);
var G__10962 = c__4150__auto___10960;
var G__10963 = cljs.core.count.call(null,c__4150__auto___10960);
var G__10964 = 0;
seq__10940_10947 = G__10961;
chunk__10941_10948 = G__10962;
count__10942_10949 = G__10963;
i__10943_10950 = G__10964;
continue;
}
} else
{var vec__10946_10965 = cljs.core.first.call(null,seq__10940_10959__$1);var ev__4336__auto___10966 = cljs.core.nth.call(null,vec__10946_10965,0,null);var func__4337__auto___10967 = cljs.core.nth.call(null,vec__10946_10965,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10966,func__4337__auto___10967);
{
var G__10968 = cljs.core.next.call(null,seq__10940_10959__$1);
var G__10969 = null;
var G__10970 = 0;
var G__10971 = 0;
seq__10940_10947 = G__10968;
chunk__10941_10948 = G__10969;
count__10942_10949 = G__10970;
i__10943_10950 = G__10971;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.popup.popup_content = (function popup_content(this$,opts){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",1013907516),new cljs.core.Keyword(null,"header","header",4087600639).cljs$core$IFn$_invoke$arity$1(opts)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),new cljs.core.Keyword(null,"body","body",1016933652).cljs$core$IFn$_invoke$arity$1(opts)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"ul.buttons","ul.buttons",666323612),(function (){var iter__4119__auto__ = (function iter__10982(s__10983){return (new cljs.core.LazySeq(null,(function (){var s__10983__$1 = s__10983;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__10983__$1);if(temp__4092__auto__)
{var s__10983__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__10983__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__10983__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__10985 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__10984 = 0;while(true){
if((i__10984 < size__4118__auto__))
{var b = cljs.core._nth.call(null,c__4117__auto__,i__10984);cljs.core.chunk_append.call(null,b__10985,lt.objs.popup.__GT_button.call(null,this$,b));
{
var G__10992 = (i__10984 + 1);
i__10984 = G__10992;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10985),iter__10982.call(null,cljs.core.chunk_rest.call(null,s__10983__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10985),null);
}
} else
{var b = cljs.core.first.call(null,s__10983__$2);return cljs.core.cons.call(null,lt.objs.popup.__GT_button.call(null,this$,b),iter__10982.call(null,cljs.core.rest.call(null,s__10983__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,cljs.core.reverse.call(null,new cljs.core.Keyword(null,"buttons","buttons",1255256819).cljs$core$IFn$_invoke$arity$1(opts)));
})()], null)], null)], null));var seq__10986_10993 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (e){lt.util.dom.prevent.call(null,e);
return lt.util.dom.stop_propagation.call(null,e);
})], null)));var chunk__10987_10994 = null;var count__10988_10995 = 0;var i__10989_10996 = 0;while(true){
if((i__10989_10996 < count__10988_10995))
{var vec__10990_10997 = cljs.core._nth.call(null,chunk__10987_10994,i__10989_10996);var ev__4336__auto___10998 = cljs.core.nth.call(null,vec__10990_10997,0,null);var func__4337__auto___10999 = cljs.core.nth.call(null,vec__10990_10997,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10998,func__4337__auto___10999);
{
var G__11000 = seq__10986_10993;
var G__11001 = chunk__10987_10994;
var G__11002 = count__10988_10995;
var G__11003 = (i__10989_10996 + 1);
seq__10986_10993 = G__11000;
chunk__10987_10994 = G__11001;
count__10988_10995 = G__11002;
i__10989_10996 = G__11003;
continue;
}
} else
{var temp__4092__auto___11004 = cljs.core.seq.call(null,seq__10986_10993);if(temp__4092__auto___11004)
{var seq__10986_11005__$1 = temp__4092__auto___11004;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10986_11005__$1))
{var c__4150__auto___11006 = cljs.core.chunk_first.call(null,seq__10986_11005__$1);{
var G__11007 = cljs.core.chunk_rest.call(null,seq__10986_11005__$1);
var G__11008 = c__4150__auto___11006;
var G__11009 = cljs.core.count.call(null,c__4150__auto___11006);
var G__11010 = 0;
seq__10986_10993 = G__11007;
chunk__10987_10994 = G__11008;
count__10988_10995 = G__11009;
i__10989_10996 = G__11010;
continue;
}
} else
{var vec__10991_11011 = cljs.core.first.call(null,seq__10986_11005__$1);var ev__4336__auto___11012 = cljs.core.nth.call(null,vec__10991_11011,0,null);var func__4337__auto___11013 = cljs.core.nth.call(null,vec__10991_11011,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___11012,func__4337__auto___11013);
{
var G__11014 = cljs.core.next.call(null,seq__10986_11005__$1);
var G__11015 = null;
var G__11016 = 0;
var G__11017 = 0;
seq__10986_10993 = G__11014;
chunk__10987_10994 = G__11015;
count__10988_10995 = G__11016;
i__10989_10996 = G__11017;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.popup.popup = (function popup(this$,opts){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.popup","div.popup",2038588545),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"tabindex","tabindex",4410954191),-1], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),lt.objs.popup.popup_content.call(null,this$,opts)], null)], null));var seq__11024_11030 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"click","click",1108654330));
})], null)));var chunk__11025_11031 = null;var count__11026_11032 = 0;var i__11027_11033 = 0;while(true){
if((i__11027_11033 < count__11026_11032))
{var vec__11028_11034 = cljs.core._nth.call(null,chunk__11025_11031,i__11027_11033);var ev__4336__auto___11035 = cljs.core.nth.call(null,vec__11028_11034,0,null);var func__4337__auto___11036 = cljs.core.nth.call(null,vec__11028_11034,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___11035,func__4337__auto___11036);
{
var G__11037 = seq__11024_11030;
var G__11038 = chunk__11025_11031;
var G__11039 = count__11026_11032;
var G__11040 = (i__11027_11033 + 1);
seq__11024_11030 = G__11037;
chunk__11025_11031 = G__11038;
count__11026_11032 = G__11039;
i__11027_11033 = G__11040;
continue;
}
} else
{var temp__4092__auto___11041 = cljs.core.seq.call(null,seq__11024_11030);if(temp__4092__auto___11041)
{var seq__11024_11042__$1 = temp__4092__auto___11041;if(cljs.core.chunked_seq_QMARK_.call(null,seq__11024_11042__$1))
{var c__4150__auto___11043 = cljs.core.chunk_first.call(null,seq__11024_11042__$1);{
var G__11044 = cljs.core.chunk_rest.call(null,seq__11024_11042__$1);
var G__11045 = c__4150__auto___11043;
var G__11046 = cljs.core.count.call(null,c__4150__auto___11043);
var G__11047 = 0;
seq__11024_11030 = G__11044;
chunk__11025_11031 = G__11045;
count__11026_11032 = G__11046;
i__11027_11033 = G__11047;
continue;
}
} else
{var vec__11029_11048 = cljs.core.first.call(null,seq__11024_11042__$1);var ev__4336__auto___11049 = cljs.core.nth.call(null,vec__11029_11048,0,null);var func__4337__auto___11050 = cljs.core.nth.call(null,vec__11029_11048,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___11049,func__4337__auto___11050);
{
var G__11051 = cljs.core.next.call(null,seq__11024_11042__$1);
var G__11052 = null;
var G__11053 = 0;
var G__11054 = 0;
seq__11024_11030 = G__11051;
chunk__11025_11031 = G__11052;
count__11026_11032 = G__11053;
i__11027_11033 = G__11054;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.object.object_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","popup","lt.objs.popup/popup",767372430),new cljs.core.Keyword(null,"tags","tags",1017456523),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"popup","popup",1120756766),null], null), null),new cljs.core.Keyword(null,"button","button",3931183780),0,new cljs.core.Keyword(null,"init","init",1017141378),(function (this$,content){return lt.objs.popup.popup.call(null,this$,content);
}));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.exec-active","popup.exec-active",2113737970),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: execute active option",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"exec-active","exec-active",533892916));
} else
{return null;
}
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.move-active","popup.move-active",920349106),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: move selection",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (dir){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"move-active","move-active",3635471348),dir);
} else
{return null;
}
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.escape","popup.escape",1937231733),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: escape",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"click","click",1108654330));
} else
{return null;
}
})], null));
lt.objs.popup.popup_BANG_ = (function popup_BANG_(options){var p = lt.object.create.call(null,new cljs.core.Keyword("lt.objs.popup","popup","lt.objs.popup/popup",767372430),options);lt.object.raise.call(null,p,new cljs.core.Keyword(null,"move-active","move-active",3635471348),0);
lt.util.dom.append.call(null,lt.util.dom.$.call(null,new cljs.core.Keyword(null,"body","body",1016933652)),lt.object.__GT_content.call(null,p));
lt.object.__GT_content.call(null,p).focus();
lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766),p);
return p;
});
lt.objs.popup.cancel_button = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"label","label",1116631654),"cancel",new cljs.core.Keyword(null,"action","action",3885920680),new cljs.core.Keyword(null,"cancel","cancel",3941147116)], null);
