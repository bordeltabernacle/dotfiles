// Compiled by ClojureScript 0.0-2138
goog.provide('lt.objs.context');
goog.require('cljs.core');
goog.require('lt.object');
goog.require('lt.object');
lt.objs.context.contexts = cljs.core.atom.call(null,cljs.core.PersistentHashSet.EMPTY);
lt.objs.context.groups = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.ctx__GT_obj = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.ctx__GT_group = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.group__GT_ctxs = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
lt.objs.context.append_group = (function append_group(group,name){return cljs.core.swap_BANG_.call(null,lt.objs.context.groups,(function (all){if(cljs.core.truth_(all.call(null,group)))
{return cljs.core.update_in.call(null,all,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [group], null),cljs.core.conj,name);
} else
{return cljs.core.assoc.call(null,all,group,cljs.core.PersistentHashSet.fromArray([name], true));
}
}));
});
lt.objs.context.in_QMARK_ = (function in_QMARK_(k){return cljs.core.deref.call(null,lt.objs.context.contexts).call(null,k);
});
lt.objs.context.out_BANG_ = (function() {
var out_BANG_ = null;
var out_BANG___1 = (function (ctxs){var ctxs__$1 = ((cljs.core.coll_QMARK_.call(null,ctxs))?ctxs:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [ctxs], null));cljs.core.swap_BANG_.call(null,lt.objs.context.contexts,(function (p1__7800_SHARP_){return cljs.core.apply.call(null,cljs.core.disj,p1__7800_SHARP_,ctxs__$1);
}));
cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_obj,(function (p1__7801_SHARP_){return cljs.core.apply.call(null,cljs.core.dissoc,p1__7801_SHARP_,ctxs__$1);
}));
return lt.object.raise.call(null,lt.objs.context.ctx_obj,new cljs.core.Keyword(null,"log!","log!",1017231567));
});
var out_BANG___2 = (function (ctxs,_){return out_BANG_.call(null,ctxs);
});
out_BANG_ = function(ctxs,_){
switch(arguments.length){
case 1:
return out_BANG___1.call(this,ctxs);
case 2:
return out_BANG___2.call(this,ctxs,_);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
out_BANG_.cljs$core$IFn$_invoke$arity$1 = out_BANG___1;
out_BANG_.cljs$core$IFn$_invoke$arity$2 = out_BANG___2;
return out_BANG_;
})()
;
/**
* @param {...*} var_args
*/
lt.objs.context.in_BANG_ = (function() { 
var in_BANG___delegate = function (ctxs,p__7804){var vec__7810 = p__7804;var obj = cljs.core.nth.call(null,vec__7810,0,null);var ctxs__$1 = ((cljs.core.coll_QMARK_.call(null,ctxs))?ctxs:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [ctxs], null));cljs.core.swap_BANG_.call(null,lt.objs.context.contexts,(function (p1__7802_SHARP_){return cljs.core.apply.call(null,cljs.core.conj,p1__7802_SHARP_,ctxs__$1);
}));
cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_obj,(function (p1__7803_SHARP_){return cljs.core.merge.call(null,p1__7803_SHARP_,cljs.core.zipmap.call(null,ctxs__$1,cljs.core.repeat.call(null,obj)));
}));
lt.object.raise.call(null,lt.objs.context.ctx_obj,new cljs.core.Keyword(null,"log!","log!",1017231567));
var seq__7811 = cljs.core.seq.call(null,ctxs__$1);var chunk__7812 = null;var count__7813 = 0;var i__7814 = 0;while(true){
if((i__7814 < count__7813))
{var c = cljs.core._nth.call(null,chunk__7812,i__7814);var temp__4092__auto___7815 = cljs.core.deref.call(null,lt.objs.context.group__GT_ctxs).call(null,cljs.core.deref.call(null,lt.objs.context.ctx__GT_group).call(null,c));if(cljs.core.truth_(temp__4092__auto___7815))
{var group_7816 = temp__4092__auto___7815;lt.objs.context.out_BANG_.call(null,group_7816);
} else
{}
{
var G__7817 = seq__7811;
var G__7818 = chunk__7812;
var G__7819 = count__7813;
var G__7820 = (i__7814 + 1);
seq__7811 = G__7817;
chunk__7812 = G__7818;
count__7813 = G__7819;
i__7814 = G__7820;
continue;
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__7811);if(temp__4092__auto__)
{var seq__7811__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__7811__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__7811__$1);{
var G__7821 = cljs.core.chunk_rest.call(null,seq__7811__$1);
var G__7822 = c__4150__auto__;
var G__7823 = cljs.core.count.call(null,c__4150__auto__);
var G__7824 = 0;
seq__7811 = G__7821;
chunk__7812 = G__7822;
count__7813 = G__7823;
i__7814 = G__7824;
continue;
}
} else
{var c = cljs.core.first.call(null,seq__7811__$1);var temp__4092__auto___7825__$1 = cljs.core.deref.call(null,lt.objs.context.group__GT_ctxs).call(null,cljs.core.deref.call(null,lt.objs.context.ctx__GT_group).call(null,c));if(cljs.core.truth_(temp__4092__auto___7825__$1))
{var group_7826 = temp__4092__auto___7825__$1;lt.objs.context.out_BANG_.call(null,group_7826);
} else
{}
{
var G__7827 = cljs.core.next.call(null,seq__7811__$1);
var G__7828 = null;
var G__7829 = 0;
var G__7830 = 0;
seq__7811 = G__7827;
chunk__7812 = G__7828;
count__7813 = G__7829;
i__7814 = G__7830;
continue;
}
}
} else
{return null;
}
}
break;
}
};
var in_BANG_ = function (ctxs,var_args){
var p__7804 = null;if (arguments.length > 1) {
  p__7804 = cljs.core.array_seq(Array.prototype.slice.call(arguments, 1),0);} 
return in_BANG___delegate.call(this,ctxs,p__7804);};
in_BANG_.cljs$lang$maxFixedArity = 1;
in_BANG_.cljs$lang$applyTo = (function (arglist__7831){
var ctxs = cljs.core.first(arglist__7831);
var p__7804 = cljs.core.rest(arglist__7831);
return in_BANG___delegate(ctxs,p__7804);
});
in_BANG_.cljs$core$IFn$_invoke$arity$variadic = in_BANG___delegate;
return in_BANG_;
})()
;
/**
* @param {...*} var_args
*/
lt.objs.context.toggle_BANG_ = (function() { 
var toggle_BANG___delegate = function (ctxs,p__7832){var vec__7838 = p__7832;var obj = cljs.core.nth.call(null,vec__7838,0,null);var seq__7839 = cljs.core.seq.call(null,ctxs);var chunk__7840 = null;var count__7841 = 0;var i__7842 = 0;while(true){
if((i__7842 < count__7841))
{var c = cljs.core._nth.call(null,chunk__7840,i__7842);if(cljs.core.truth_(lt.objs.context.in_QMARK_.call(null,c)))
{lt.objs.context.out_BANG_.call(null,c);
} else
{lt.objs.context.in_BANG_.call(null,c,obj);
}
{
var G__7843 = seq__7839;
var G__7844 = chunk__7840;
var G__7845 = count__7841;
var G__7846 = (i__7842 + 1);
seq__7839 = G__7843;
chunk__7840 = G__7844;
count__7841 = G__7845;
i__7842 = G__7846;
continue;
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__7839);if(temp__4092__auto__)
{var seq__7839__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__7839__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__7839__$1);{
var G__7847 = cljs.core.chunk_rest.call(null,seq__7839__$1);
var G__7848 = c__4150__auto__;
var G__7849 = cljs.core.count.call(null,c__4150__auto__);
var G__7850 = 0;
seq__7839 = G__7847;
chunk__7840 = G__7848;
count__7841 = G__7849;
i__7842 = G__7850;
continue;
}
} else
{var c = cljs.core.first.call(null,seq__7839__$1);if(cljs.core.truth_(lt.objs.context.in_QMARK_.call(null,c)))
{lt.objs.context.out_BANG_.call(null,c);
} else
{lt.objs.context.in_BANG_.call(null,c,obj);
}
{
var G__7851 = cljs.core.next.call(null,seq__7839__$1);
var G__7852 = null;
var G__7853 = 0;
var G__7854 = 0;
seq__7839 = G__7851;
chunk__7840 = G__7852;
count__7841 = G__7853;
i__7842 = G__7854;
continue;
}
}
} else
{return null;
}
}
break;
}
};
var toggle_BANG_ = function (ctxs,var_args){
var p__7832 = null;if (arguments.length > 1) {
  p__7832 = cljs.core.array_seq(Array.prototype.slice.call(arguments, 1),0);} 
return toggle_BANG___delegate.call(this,ctxs,p__7832);};
toggle_BANG_.cljs$lang$maxFixedArity = 1;
toggle_BANG_.cljs$lang$applyTo = (function (arglist__7855){
var ctxs = cljs.core.first(arglist__7855);
var p__7832 = cljs.core.rest(arglist__7855);
return toggle_BANG___delegate(ctxs,p__7832);
});
toggle_BANG_.cljs$core$IFn$_invoke$arity$variadic = toggle_BANG___delegate;
return toggle_BANG_;
})()
;
lt.objs.context.current = (function current(){return cljs.core.deref.call(null,lt.objs.context.contexts);
});
lt.objs.context.group_BANG_ = (function group_BANG_(ctx,group){cljs.core.swap_BANG_.call(null,lt.objs.context.ctx__GT_group,cljs.core.assoc,ctx,group);
return cljs.core.swap_BANG_.call(null,lt.objs.context.group__GT_ctxs,cljs.core.update_in,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [group], null),cljs.core.conj,ctx);
});
lt.objs.context.__GT_obj = (function __GT_obj(ctx){return cljs.core.deref.call(null,lt.objs.context.ctx__GT_obj).call(null,ctx);
});
lt.objs.context.enqueue = (function enqueue(coll,buffer,size){if(cljs.core._EQ_.call(null,size,cljs.core.count.call(null,buffer)))
{return cljs.core.conj.call(null,cljs.core.pop.call(null,buffer),coll);
} else
{return cljs.core.conj.call(null,buffer,coll);
}
});
lt.objs.context.__BEH__log = (function __BEH__log(this$){var size = new cljs.core.Keyword(null,"buffer-size","buffer-size",4237691104).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$));var ctx = cljs.core.deref.call(null,lt.objs.context.contexts);return lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"history","history",1940838406)], null),(function (p1__7856_SHARP_){return lt.objs.context.enqueue.call(null,ctx,p1__7856_SHARP_,size);
}));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.context","log","lt.objs.context/log",4046231399),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.context.__BEH__log,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"log!","log!",1017231567),null], null), null),new cljs.core.Keyword(null,"debounce","debounce",1556599227),16);
lt.object.object_STAR_.call(null,new cljs.core.Keyword("lt.objs.context","context","lt.objs.context/context",4461036756),new cljs.core.Keyword(null,"tags","tags",1017456523),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"context","context",1965435169),null], null), null),new cljs.core.Keyword(null,"history","history",1940838406),cljs.core.PersistentQueue.EMPTY,new cljs.core.Keyword(null,"buffer-size","buffer-size",4237691104),8,new cljs.core.Keyword(null,"init","init",1017141378),(function (this$){return null;
}));
lt.objs.context.ctx_obj = lt.object.create.call(null,new cljs.core.Keyword("lt.objs.context","context","lt.objs.context/context",4461036756));
